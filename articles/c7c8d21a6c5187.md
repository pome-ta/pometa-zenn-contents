---
title: 'ã€åŸºæœ¬ç·¨ã€‘#1: a-Shell(mini) ã§ã‚¢ãƒ—ãƒªã‚’ã¤ãã‚‹ã€Rubicon-ObjCã€‘'
emoji: 'ğŸ”°'
type: 'tech' # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ†ã‚™ã‚¢
topics: []
published: false
---

# ã¯ã˜ã‚ã«

iPhone, iPad ã®ç„¡æ–™ã‚¢ãƒ—ãƒª[a-Shell](https://holzschu.github.io/a-Shell_iOS/) ã§ã€[UIKit](https://developer.apple.com/jp/documentation/uikit/) ã‚’å‘¼ã³å‡ºã—ã‚¢ãƒ—ãƒªã‚’ã¤ãã‚Šã¾ã™ï¼ˆStore ã¸ã®å…¬é–‹ã¯ã§ãã¾ã›ã‚“ï¼‰ã€‚

ä»Šå›ã®æ–¹æ³•ã¯ã€Swift ã‚„Objective-C ã§ã¯ãªãï¼ˆa-Shell å†…ã®ï¼‰Python ã§ã™ã€‚è¨€èªãŒé•ã†ã®ã§ã€èª­ã¿æ›¿ãˆãƒ»æ›¸ãæ›¿ãˆãŒå¿…è¦ã§ã™ãŒã€Rubicon-ObjC ã«ã‚ˆã‚Šå¹¾åˆ†ã‹å®¹æ˜“ã«ã¯ãªã£ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã€‚


## 3éƒ¨æ§‹æˆ

ã“ã®è¨˜äº‹ã‚’å«ã‚ã€3éƒ¨æ§‹æˆã§è§£èª¬ã‚’ã—ã¦ã„ãã¾ã™:

- ã€åŸºæœ¬ç·¨ã€‘#1: a-Shell(mini) ã¦ã‚™ã‚¢ãƒ•ã‚šãƒªã‚’ã¤ãã‚‹ã€Rubicon-ObjCã€‘
  - ï¼ˆä»Šå›ã¯ã“ã“ï¼‰
  - a-Shell å®Ÿè¡Œã®å¤§ã¾ã‹ãªæµã‚Œ
  - 1ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã®ç°¡æ˜“ãªå®Ÿè£…

- ã€module ç·¨ã€‘#2: a-Shell(mini) ã¦ã‚™ã‚¢ãƒ•ã‚šãƒªã‚’ã¤ãã‚‹ã€Rubicon-ObjCã€‘
  - 1ãƒ•ã‚¡ã‚¤ãƒ«ã ã£ãŸã‚³ãƒ¼ãƒ‰ã‚’module ã¸åˆ†å‰²
  - å„éƒ¨ã‚³ãƒ¼ãƒ‰ã®è©³ç´°è§£èª¬
  - ã‚¢ãƒ—ãƒªåˆ¶ä½œã®ãŸã‚ã®ç’°å¢ƒæ•´å‚™

- ã€ã‚¢ãƒ—ãƒªåˆ¶ä½œç·¨ã€‘#3: a-Shell(mini) ã®Python ã§UIKit ã‹ã‚‰View ã‚’å‘¼ã³å‡ºã™ã€Rubicon-ObjCã€‘
  - Rubicon-ObjC ã‚’ä½¿ã£ãŸå®Ÿè£…ã®æµã‚Œ
  - Swift, Objective-C ã®ã‚³ãƒ¼ãƒ‰ã‚’Rubicon-ObjC ã¸è½ã¨ã—è¾¼ã¿


3ã¤ã®è¨˜äº‹ã‚’é€šã—ãŸã‚³ãƒ¼ãƒ‰ã¯ã€GitHub ã§å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚

@[card](https://github.com/pome-ta/a-Shell_Rubicon-ObjC_UIKitSamples)


ã“ã® [ãƒªãƒ³ã‚¯å…ˆ](https://github.com/pome-ta/a-Shell_Rubicon-ObjC_UIKitSamples/archive/refs/heads/main.zip) ã‚ˆã‚Šã€`.zip` ã‚’ç›´æ¥ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚

:::message
a-Shell ä»¥å¤–ã« [Pythonista for iOS](https://omz-software.com/pythonista/index.html) ã§ã€æŒ™å‹•ã®ç¢ºèªãŒã§ãã¦ã„ã¾ã™ã€‚
:::



## a-Shell(mini)

- [a-Shell(App Store Link)](https://apps.apple.com/jp/app/a-shell/id1473805438)
    - [a-Shell](https://holzschu.github.io/a-Shell_iOS/)
  - æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³:`1.15.11`ï¼ˆ2025å¹´3æœˆæ™‚ç‚¹ï¼‰
- [a-Shell mini(App Store Link)](https://apps.apple.com/jp/app/a-shell-mini/id1543537943)
  - a-Shell è»½é‡ç‰ˆã® mini
    - ã“ã®è¨˜äº‹ã§ã¯mini ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
  - [a-Shell](https://holzschu.github.io/a-Shell_iOS/)
  - æ—¥æœ¬èªè¨³: [a-shell/README_ja.md at master Â· holzschu/a-shell Â· GitHub](https://github.com/holzschu/a-shell/blob/master/README_ja.md)
  - æœ‰å¿—ã®ã‚¬ã‚¤ãƒ‰ãƒ–ãƒƒã‚¯
    - [About the book | A guide to a-Shell](https://bianshen00009.gitbook.io/a-guide-to-a-shell)

- @[card](https://github.com/holzschu/a-shell/blob/master/README_ja.md)
- @[card](https://bianshen00009.gitbook.io/a-guide-to-a-shell)

a-Shell ã§ã®ç·¨é›†ãŒå›°é›£ã€ã¾ãŸã¯æ—¢ã«å®Ÿè¡Œã—ãŸã„ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆã¯ã€ã‚¢ãƒ—ãƒªå¤–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰`pickFolder` ã‚„ã€Git ã‚’ä½¿ã£ãŸï¼ˆå°å…¥æ–¹æ³•ã¯å‰²æ„›ï¼‰é–‹ç™ºã‚‚ã§ãã¾ã™ã€‚

[Sandbox and Bookmarks | holzschu/a-shell: A terminal for iOS, with multiple windows](https://github.com/holzschu/a-shell?tab=readme-ov-file#sandbox-and-bookmarks)


## Rubicon-ObjC

- [GitHub - beeware/rubicon-objc: A bridge interface between Python and Objective-C.](https://github.com/beeware/rubicon-objc)
    - [rubicon-objc Â· PyPI](https://pypi.org/project/rubicon-objc/)
  - Python ã¸Objective-C API ã‚’ãƒ•ã‚™ãƒªãƒƒã‚·ã‚™ã™ã‚‹Python ãƒ¢ã‚·ã‚™ãƒ¥ãƒ¼ãƒ«
  - æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³:0.5.0ï¼ˆ2025å¹´3æœˆæ™‚ç‚¹ï¼‰
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
  - [Rubicon 0.5.0](https://rubicon-objc.readthedocs.io/en/stable/)
  - [Pythonistaã§Rubicon-ObjCã‚’ä½¿ã†](https://zenn.dev/qqfunc/articles/b39a657990c9f0)
  - [ã€éæ¨å¥¨ã€‘Rubicon-ObjC ã®æ‰‹å‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»ã‚¤ãƒ³ãƒ›ã‚šãƒ¼ãƒˆ](https://zenn.dev/pometa/articles/466cd4b39f9684)
    - ç§ã®è¨˜äº‹ã§ã™ã€ä»Šå›ã¯ã“ã®æ–¹æ³•ã‚’ä½¿ã£ã¦ã„ãã¾ã™



# ã‚³ãƒ¼ãƒ‰ã®å¤§ã¾ã‹ãªå‡¦ç†ã®æµã‚Œ

å…ˆã«ã€å‡¦ç†ã®æµã‚Œã‚’ã–ã£ãã‚Šã¨è¦‹ã¦ã¿ã¾ã™ã€‚

ãªãŠã€ä»Šå›ã®å®Ÿè£…ã§ã¯ä»¥ä¸‹ã®çŠ¶æ…‹ã‚’ç›®æŒ‡ã—ã¾ã™:
- View ã‚’é–‰ã—ã‚™ãŸå¾Œã‚‚ã€a-Shell ã‚’é€šå¸¸å‹•ä½œã¦ã‚™ä½¿ç”¨ã™ã‚‹ã¨ã“ãŒã¦ã‚™ãã‚‹
- å‘¼ã³å‡ºã—ãŸView ã¯ã€è‡ªåˆ†è‡ªèº«ã®View ã‚’é–‰ã˜ã‚‹ã“ã¨ãŒã§ãã‚‹


## Python ã®å®Ÿè¡Œã‹ã‚‰ã€view ãŒé–‰ã˜ã‚‹ã¾ã§

1. Application(a-Shell) ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‹ã‚‰ã€`rootViewController` ã‚’å–å¾—
1. `mainThread` ä¸Šã§ã€å®Ÿè£…ã—ãŸViewController ã‚’`rootViewController` ã¸`present`
1. View ãŒè¡¨ç¤ºã•ã‚Œã‚‹
1. Rubicon-ObjC ã®`event_loop` ã‹ã‚™èµ°ã‚‹
1. View ãŒé–‰ã˜ã‚‹éš›ã«`event_loop` ã‚’åœæ­¢
1. a-Shell ã«æˆ»ã‚‹


é€šå¸¸Xcode ã®é–‹ç™ºã¯ã€`@UIApplicationMain`ï¼ˆObjective-C ã¯ã€`main` é–¢æ•°ï¼‰ã‹ã‚‰å§‹ã¾ã‚Šã¾ã™ã€‚

ä»Šå›ã¯ã€a-Shell å´ã§ **ã€Œèµ·å‹•æ™‚ã®`AppDelegate` ã‚’æ¸ˆã¾ã›ã¦ã„ã‚‹ã€** ã¨è¦‹ç«‹ã¦ **ã€Œa-Shell ã¸`UIViewController`ï¼ˆ`UINavigationController`ï¼‰ã‚’è¿½åŠ ã™ã‚‹ã€** ã¨ã„ã†è€ƒãˆæ–¹ã§View ã‚’è¡¨ç¤ºã•ã›ã¾ã™ã€‚



# ã‚³ãƒ¼ãƒ‰ã®ã–ã£ãã‚Šèª¬æ˜

ã‚³ãƒ¼ãƒ‰ã¯ã€è¨˜äº‹ã€[ã€éæ¨å¥¨ã€‘Rubicon-ObjC ã®æ‰‹å‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»ã‚¤ãƒ³ãƒ›ã‚šãƒ¼ãƒˆ](https://zenn.dev/pometa/articles/466cd4b39f9684)ã€ã®ç’°å¢ƒè¨­å®šã¨ã—ã¾ã™ã€‚

@[card](https://zenn.dev/pometa/articles/466cd4b39f9684)ã€ã®ç’°å¢ƒè¨­å®šã¨ã—ã¾ã™ã€‚


:::message
pip ç­‰ã§Rubicon-ObjC ã‚’å…¥ã‚ŒãŸå ´åˆã«ã¯:

``` diff py:æ›¸ãæ›ãˆ
- from pyrubicon.objc.ã€œ import ã€œ
+ from rubicon.objc.ã€œ import ã€œ

```

ã¨ã€`pyrubicon` ã‚’`rubicon` ã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚
:::


## å…¨ä½“

ä»Šå›ã¯ã€Rubicon-ObjC ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã€1ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`singleFileSample.py`ï¼‰ã®ã¿ã®æ§‹æˆã§ã™ã€‚


``` python:singleFileSample.py
import ctypes

from pyrubicon.objc.api import ObjCClass, ObjCInstance, Block
from pyrubicon.objc.api import objc_method
from pyrubicon.objc.runtime import objc_id, send_super, SEL
# todo: utils ###############################################
from pyrubicon.objc.runtime import Class, Foundation
# todo: lifeCycle ###########################################
import asyncio
import logging
from pyrubicon.objc.eventloop import EventLoopPolicy
# todo: exception ###########################################
import sys
import os
# todo: mainThread ##########################################
import functools
from pyrubicon.objc.runtime import libobjc, objc_block

ObjCClass.auto_rename = True


#############################################################
# --- utils
#############################################################
def NSStringFromClass(cls: Class) -> ObjCInstance:
  _NSStringFromClass = Foundation.NSStringFromClass
  _NSStringFromClass.restype = ctypes.c_void_p
  _NSStringFromClass.argtypes = [Class]
  return ObjCInstance(_NSStringFromClass(cls))


#############################################################
# --- exception
#############################################################
# todo: from objc_util.py of Pythonista3
ExceptionHandlerFuncType = ctypes.CFUNCTYPE(None, ctypes.c_void_p)


def NSSetUncaughtExceptionHandler(_exc: ExceptionHandlerFuncType) -> None:
  _NSSetUncaughtExceptionHandler = Foundation.NSSetUncaughtExceptionHandler
  _NSSetUncaughtExceptionHandler.restype = None
  _NSSetUncaughtExceptionHandler.argtypes = [
    ExceptionHandlerFuncType,
  ]
  _NSSetUncaughtExceptionHandler(_exc)


def _objc_exception_handler(_exc):
  exc = ObjCInstance(_exc)
  with open(os.path.expanduser('~/Documents/_rubicon_objc_exception.txt'),
            'w') as f:
    import datetime
    f.write(
      'The app was terminated due to an Objective-C exception. Details below:\n\n%s\n%s\n'
      % (datetime.datetime.now(), exc))


_handler = ExceptionHandlerFuncType(_objc_exception_handler)
NSSetUncaughtExceptionHandler(_handler)

#############################################################
# --- lifeCycle
#############################################################
#logging.basicConfig(level=logging.DEBUG)
asyncio.set_event_loop_policy(EventLoopPolicy())
loop = asyncio.new_event_loop()
#loop.set_debug(True)

#############################################################
# --- mainThread
#############################################################
NSThread = ObjCClass('NSThread')


class struct_dispatch_queue_s(ctypes.Structure):
  pass  # No _fields_, because this is an opaque structure.


_dispatch_main_q = struct_dispatch_queue_s.in_dll(libobjc, '_dispatch_main_q')


def dispatch_get_main_queue():
  return ObjCInstance(ctypes.cast(ctypes.byref(_dispatch_main_q), objc_id))


libobjc.dispatch_async.restype = None
libobjc.dispatch_async.argtypes = [
  objc_id,
  objc_block,
]


def onMainThread(func):

  @functools.wraps(func)
  def wrapper(*args, **kwargs):
    if NSThread.isMainThread:
      func(*args, **kwargs)
    block = Block(functools.partial(func, *args, **kwargs), None)
    libobjc.dispatch_async(dispatch_get_main_queue(), block)

  return wrapper


#############################################################
# --- UINavigationController
#############################################################
UINavigationController = ObjCClass('UINavigationController')
UINavigationBarAppearance = ObjCClass('UINavigationBarAppearance')
UIBarButtonItem = ObjCClass('UIBarButtonItem')


class RootNavigationController(UINavigationController):

  @objc_method
  def dealloc(self):
    # xxx: å‘¼ã¯ã‚™ãªã„-> `send_super(__class__, self, 'dealloc')`
    print(f'- {NSStringFromClass(__class__)}: dealloc')
    # --- (5) ###############################################
    loop.stop()
    print('--- stop')

  @objc_method
  def loadView(self):
    send_super(__class__, self, 'loadView')
    print(f'{NSStringFromClass(__class__)}: loadView')
    navigationBarAppearance = UINavigationBarAppearance.new()
    navigationBarAppearance.configureWithDefaultBackground()
    #navigationBarAppearance.configureWithOpaqueBackground()
    #navigationBarAppearance.configureWithTransparentBackground()

    navigationBar = self.navigationBar
    navigationBar.standardAppearance = navigationBarAppearance
    navigationBar.scrollEdgeAppearance = navigationBarAppearance
    navigationBar.compactAppearance = navigationBarAppearance
    navigationBar.compactScrollEdgeAppearance = navigationBarAppearance

  @objc_method
  def viewDidLoad(self):
    send_super(__class__, self, 'viewDidLoad')
    print(f'{NSStringFromClass(__class__)}: viewDidLoad')
    self.delegate = self

  @objc_method
  def viewWillAppear_(self, animated: bool):
    send_super(__class__,
               self,
               'viewWillAppear:',
               animated,
               argtypes=[
                 ctypes.c_bool,
               ])
    print(f'{NSStringFromClass(__class__)}: viewWillAppear_')

  @objc_method
  def viewDidAppear_(self, animated: bool):
    send_super(__class__,
               self,
               'viewDidAppear:',
               animated,
               argtypes=[
                 ctypes.c_bool,
               ])
    print(f'{NSStringFromClass(__class__)}: viewDidAppear_')
    print('â†“ ---')

  @objc_method
  def viewWillDisappear_(self, animated: bool):
    print('â†‘ ---')
    send_super(__class__,
               self,
               'viewWillDisappear:',
               animated,
               argtypes=[
                 ctypes.c_bool,
               ])
    print(f'{NSStringFromClass(__class__)}: viewWillDisappear_')

  @objc_method
  def viewDidDisappear_(self, animated: bool):
    send_super(__class__,
               self,
               'viewDidDisappear:',
               animated,
               argtypes=[
                 ctypes.c_bool,
               ])
    print(f'{NSStringFromClass(__class__)}: viewDidDisappear_')

  @objc_method
  def didReceiveMemoryWarning(self):
    send_super(__class__, self, 'didReceiveMemoryWarning')
    print(f'{NSStringFromClass(__class__)}: didReceiveMemoryWarning')

  @objc_method
  def doneButtonTapped_(self, sender):
    print(f'{NSStringFromClass(__class__)}: doneButtonTapped:')
    self.dismissViewControllerAnimated_completion_(True, None)

  @objc_method
  def navigationController_willShowViewController_animated_(
      self, navigationController, viewController, animated: bool):
    closeButtonItem = UIBarButtonItem.alloc().initWithBarButtonSystemItem(
      24, target=navigationController, action=SEL('doneButtonTapped:'))

    visibleViewController = navigationController.visibleViewController
    navigationItem = visibleViewController.navigationItem
    navigationItem.rightBarButtonItem = closeButtonItem


#############################################################
# --- UIViewController
#############################################################
UIViewController = ObjCClass('UIViewController')


class MainViewController(UIViewController):

  @objc_method
  def dealloc(self):
    # xxx: å‘¼ã¯ã‚™ãªã„-> `send_super(__class__, self, 'dealloc')`
    print(f'\t - {NSStringFromClass(__class__)}: dealloc')

  @objc_method
  def loadView(self):
    send_super(__class__, self, 'loadView')
    print(f'\t{NSStringFromClass(__class__)}: loadView')

  @objc_method
  def viewDidLoad(self):
    send_super(__class__, self, 'viewDidLoad')
    print(f'\t{NSStringFromClass(__class__)}: viewDidLoad')
    self.navigationItem.title = NSStringFromClass(__class__)

  @objc_method
  def viewWillAppear_(self, animated: bool):
    send_super(__class__,
               self,
               'viewWillAppear:',
               animated,
               argtypes=[
                 ctypes.c_bool,
               ])
    print(f'\t{NSStringFromClass(__class__)}: viewWillAppear_')

  @objc_method
  def viewDidAppear_(self, animated: bool):
    send_super(__class__,
               self,
               'viewDidAppear:',
               animated,
               argtypes=[
                 ctypes.c_bool,
               ])
    print(f'\t{NSStringFromClass(__class__)}: viewDidAppear_')
    print('\tâ†“ ---')

  @objc_method
  def viewWillDisappear_(self, animated: bool):
    print('\tâ†‘ ---')
    send_super(__class__,
               self,
               'viewWillDisappear:',
               animated,
               argtypes=[
                 ctypes.c_bool,
               ])
    print(f'\t{NSStringFromClass(__class__)}: viewWillDisappear_')

  @objc_method
  def viewDidDisappear_(self, animated: bool):
    send_super(__class__,
               self,
               'viewDidDisappear:',
               animated,
               argtypes=[
                 ctypes.c_bool,
               ])
    print(f'\t{NSStringFromClass(__class__)}: viewDidDisappear_')

  @objc_method
  def didReceiveMemoryWarning(self):
    send_super(__class__, self, 'didReceiveMemoryWarning')
    print(f'\t{NSStringFromClass(__class__)}: didReceiveMemoryWarning')


#############################################################
# --- app present
#############################################################
UIApplication = ObjCClass('UIApplication')


class App:

  # --- (1) #################################################
  sharedApplication = UIApplication.sharedApplication
  __objectEnumerator = sharedApplication.connectedScenes.objectEnumerator()
  while (__windowScene := __objectEnumerator.nextObject()):
    if __windowScene.activationState == 0:
      break
  rootViewController = __windowScene.keyWindow.rootViewController

  def __init__(self, viewController, modalPresentationStyle=1):
    self.viewController = viewController
    self.modalPresentationStyle = modalPresentationStyle

  def present(self):

    # --- (2) ###############################################
    @onMainThread
    def present_viewController(viewController: UIViewController, style: int):

      presentViewController = RootNavigationController.alloc(
      ).initWithRootViewController_(viewController)

      presentViewController.setModalPresentationStyle_(style)

      self.rootViewController.presentViewController_animated_completion_(
        presentViewController, True, None)

    # --- (3) ###############################################
    present_viewController(self.viewController, self.modalPresentationStyle)
    self.main_loop()

  def main_loop(self):
    # --- (4) ###############################################
    loop.run_forever()
    loop.close()


if __name__ == '__main__':
  print('--- run ---')
  main_vc = MainViewController.new()
  presentation_style = 1

  app = App(main_vc, presentation_style)
  app.present()
  print('--- end ---')
  # --- (6) #################################################

```

ã‚³ã‚¢ã¨ãªã‚‹éƒ¨åˆ†ã‚’é †ã«èª¬æ˜ã—ã¦ã„ãã¾ã™ã€‚ã‚‚ã†å°‘ã—è¸ã¿è¾¼ã‚“ã è§£èª¬ã¯ã€module ç·¨ã‚’ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚


## class: `App`

a-Shell ã¨å®Ÿè£…ã—ãŸã‚³ãƒ¼ãƒˆã‚™ã‚’é€£æºã™ã‚‹å½¹å‰²ã§ã™ã€‚å¾Œè¿°ã™ã‚‹`mainThread` ã¨`event_loop` ç®¡ç†ã‚‚ã“ã“ã§å¼•ãå—ã‘ã¾ã™ã€‚


ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”Ÿæˆæ™‚ã«ã€ViewController ã¨è¡¨ç¤ºå½¢å¼ã®Style ã‚’æŒ‡å®šã—ã¾ã™ã€‚`app.present` ã™ã‚‹ã“ã¨ã§View ã‚’è¡¨ç¤ºã•ã›ã¾ã™ã€‚

``` python
app = App(main_vc, presentation_style)
app.present()
```

### è¡¨ç¤ºå½¢å¼ã®Style

è©³ç´°ã¯ã€module ç·¨ã¨ã—ã¾ã™ãŒã€ä»¥ä¸‹ã®`int` ã§æŒ‡å®šã§ãã¾ã™:

```
automatic          = -2
none               = -1
fullScreen         =  0
pageSheet          =  1
formSheet          =  2
currentContext     =  3
custom             =  4
overFullScreen     =  5
overCurrentContext =  6
popover            =  7
blurOverFullScreen =  8
```

[UIModalPresentationStyle | Apple Developer Documentation](https://developer.apple.com/documentation/uikit/uimodalpresentationstyle)

## ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿:`@onMainThread`

UI ã®æ›´æ–°ã¯ã€mainThread ã§è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãã“ã§ã€mainThread ã§å‡¦ç†ã—ãŸã„é–¢æ•°ãƒ»ãƒ¡ã‚½ãƒƒãƒ‰ã«`@onMainThread` ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’æŒ‡å®šã—ã¾ã™ã€‚


``` python
@onMainThread
def present_viewController(viewController: UIViewController, style: int):
  # UI ã®æ›´æ–°å‡¦ç†

```

@[card](https://rubicon-objc.readthedocs.io/en/stable/how-to/c-functions.html#a-complex-example-dispatch-get-main-queue)

@[card](https://zenn.dev/qqfunc/articles/b39a657990c9f0#:~:text=%E3%83%A1%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89)



## event loop: `EventLoopPolicy`

event loop ã®`loop` å¤‰æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚`run_forever` ã§event loop ãŒèµ°ã‚Šã€`stop` ãŒå‘¼ã°ã‚Œã‚‹ã¾ã§ç¶šãã¾ã™ã€‚

``` python
asyncio.set_event_loop_policy(EventLoopPolicy())
loop = asyncio.new_event_loop()

loop.run_forever()
loop.stop()
loop.close()
```

`stop` å¾Œã€`close` ã‚’å‘¼ã³çµ‚äº†ã•ã›ãªã„ã¨ã€a-Shell ãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ã¾ã™ï¼ˆPythonista3 ã¯ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ã¾ã›ã‚“ï¼‰ã€‚




[Asynchronous Programming with Rubicon - Rubicon 0.5.0](https://rubicon-objc.readthedocs.io/en/stable/how-to/async.html#integrating-asyncio-with-corefoundation)


## class: `RootNavigationController`


ä»Šå›ã®å®Ÿè£…ã¦ã‚™ã¯ã€View ã®å³è‚©ã«`close` ã®ãƒ›ã‚™ã‚¿ãƒ³ã‚’ç”¨æ„ã€ãƒ›ã‚™ã‚¿ãƒ³ã‹ã‚™æŠ¼ã•ã‚ŒãŸã‚‰View ã‚’é–‰ã—ã‚™ã¦a-Shell ã«æˆ»ã—ã¾ã™ã€‚

- `doneButtonTapped:` ãƒ¡ã‚½ãƒƒãƒ‰
  - è‡ªåˆ†è‡ªèº«ã®View ã‚’é–‰ã˜ã‚‹å‡¦ç†
  - é–‰ã˜ã‚‹éš›ï¼ˆ`dealloc` ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼‰ã«event loop ã‚’`stop`
- `close` ãƒœã‚¿ãƒ³ã«`doneButtonTapped:` ã‚’selectorï¼ˆ`SEL`ï¼‰ ã¨ã—ã¦è¨­ç½®

iPhone, iPad ã‚¢ãƒ—ãƒªã¯é€šå¸¸ã€Background ã‚’ã‚¹ãƒ¯ã‚¤ãƒ—ã—ã¦çµ‚äº†ã•ã›ã¾ã™ã€‚

èµ·å‹•ã—ã¦ã„ã‚‹ãƒ¡ã‚¤ãƒ³ã®ã‚¢ãƒ—ãƒªã¯a-Shell ã§ã‚ã‚Šã€å®Ÿè£…ã—ãŸView ã¯ã‚µãƒ–ã¨ã„ã†ç«‹ã¡ä½ç½®ã§è€ƒãˆã¾ã™ã€‚




## class: `MainViewController`

ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè£…ã™ã‚‹class ã§ã™ã€‚

## ãã®ä»–

### é–¢æ•°: `ObjCClass.auto_rename`

å®Ÿè£…ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’é€£ç¶šã§å®Ÿè¡Œã™ã‚‹éš›ã®ã‚¨ãƒ©ãƒ¼ã‚’å›é¿ã—ã¾ã™ã€‚


[Class naming | Tutorial 2 - Writing your own class - Rubicon 0.5.0](https://rubicon-objc.readthedocs.io/en/stable/tutorial/tutorial-2.html#class-naming)

[Objective-Cã‚¯ãƒ©ã‚¹ã®å®šç¾© | Pythonistaã¦ã‚™Rubicon-ObjCã‚’ä½¿ã†](https://zenn.dev/qqfunc/articles/b39a657990c9f0#:~:text=Objective%2DC%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E5%AE%9A%E7%BE%A9)



### é–¢æ•°: `NSStringFromClass`


class åã‚’æ–‡å­—åˆ—ã§è¿”ã—ã¾ã™ã€‚

å¿…é ˆã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ä»Šå›ã¯View ã®Life Cycle ç¢ºèªã¨ã—ã¦ä½¿ç”¨ã—ã¾ã™ã€‚


[NSStringFromClass | Apple Developer Documentation](https://developer.apple.com/documentation/foundation/1395143-nsstringfromclass?language=objc)



### é–¢æ•°: `NSSetUncaughtExceptionHandler`

ã‚¨ãƒ©ãƒ¼æ™‚ã«ãƒ›ãƒ¼ãƒ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆ`./Documents`ï¼‰ç›´ä¸‹ã«ãƒ­ã‚°ã‚’åãã¾ã™ã€‚

å®Ÿè£…å†…å®¹ã¯Pythonista3 ã®`objc_util,py` ã‚’å‚è€ƒã«ã—ã¦ã„ã¾ã™ã€‚





# ãŠã‚ã‚Šã«

a-Shell ã‚¢ãƒ—ãƒªè‡ªèº«ã¨ã€Python å®Ÿè£…ã®ViewController é€£æºãŒã§ãã¾ã—ãŸã€‚

ç¹‹ãè¾¼ã¿ã®éƒ¨åˆ†ã¯å¤šå°‘hacky ã«ãªã£ã¦ã—ã¾ã„ã¾ã—ãŸãŒã€å…¨ä½“ã®å‡¦ç†ã®æµã‚ŒãŒã–ã£ãã‚Šã¨æ´ã‚“ã§ã‚‚ã‚‰ãˆã¦ã„ãŸã‚‰å¬‰ã—ã„ã§ã™ã€‚

ä»Šå›ã¯ã€1ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚³ãƒ¼ãƒ‰ã‚’å…¨ã¦è©°ã‚è¾¼ã‚“ã§ã—ã¾ã£ãŸã®ã§ã€æ¬¡å›ã¯ãã®ã‚³ãƒ¼ãƒ‰ç¾¤ã‚’åˆ†ã‘ã¦module åŒ–ã—ã¦ã„ãã¾ã™ã€‚





==== === ===

#### è¡¨ç¤ºå½¢å¼ã®Style

`UIModalPresentationStyle` ã®Enumeration Case ã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚

[UIModalPresentationStyle | Apple Developer Documentation](https://developer.apple.com/documentation/uikit/uimodalpresentationstyle)

```
automatic          = -2
none               = -1
fullScreen         =  0
pageSheet          =  1
formSheet          =  2
currentContext     =  3
custom             =  4
overFullScreen     =  5
overCurrentContext =  6
popover            =  7
blurOverFullScreen =  8
```


ãªãŠã€Apple Developer Documentation ã¦ã‚™Enumeration Case ã¯(Swift ã‚‚Objective-C ã®ãƒ˜ã‚šãƒ¼ã‚·ã‚™ã‚‚)å€¤ã‚„å‹ã™ã‚‰ã‚‚ä¸æ˜ãªã“ã¨ã‹ã‚™å¤šã„ã¦ã‚™ã™ã€‚


ãã®å ´åˆã¯:

- [#40 pub struct UIModalPresentationStyle | UIViewController.rs - source](https://docs.rs/objc2-ui-kit/latest/src/objc2_ui_kit/generated/UIViewController.rs.html#40)

Rust è£½Apple frameworks ãƒã‚™ã‚¤ãƒ³ãƒ†ã‚™ã‚£ãƒ³ã‚¯ã‚™ ã®source ã‚’ç¢ºèªã—ã¾ã™ã€‚


