---
title: "ã€printã€‘objc_util ã‹ã‚‰rubicon-objc ã¸ç§»è¡Œã€ãƒ‡ãƒãƒƒã‚°ã€‘"
emoji: "ğŸ“²"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Python", "iOS", "objectivec", "Pythonista3", "rubiconobjc"]
published: true
---

## objc_util ã§ç‹¬è‡ªã«ä½œã£ã¦æ´»ç”¨ã—ã¦ã„ãŸã‚‚ã®

[objc_util ã®print ãƒ‡ãƒãƒƒã‚°ã€‚Pythonista3 ã®é»’é­”è¡“ #Python - Qiita](https://qiita.com/pome-ta/items/fd66f3c1c7ee6a34282e)
@[card](https://qiita.com/pome-ta/items/fd66f3c1c7ee6a34282e)

objc_util ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æŒã£ã¦ã„ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç¢ºèªã™ã‚‹æ™‚ã«æ´»ç”¨ã—ã¦ã„ãŸãŒã€objc_util ä¾å­˜ãªã®ã§ã€rubicon ã«æ›¸ãæ›ãˆãŸã€‚
rubicon ã§ã¯ã€objc_util ãã£ãã‚Šã«ã¯ã„ã‹ãªã„ã®ã§ã€ï¼ˆå†™çµŒã—ã¤ã¤ï¼‰æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã¿ãŸã€‚

### å®Ÿè£…å…¨å®¹

```python:pdbr.py
import ctypes
import json
from pprint import pprint

from rubicon.objc.api import ObjCInstance, NSObject
from rubicon.objc.runtime import libobjc

__all__ = [
  'state',
]

NSObject_instance_methods = [
  'init',
  'copy',
  'mutableCopy',
  'dealloc',
  'performSelector_withObject_afterDelay_',
  'performSelectorOnMainThread_withObject_waitUntilDone_',
  'performSelectorInBackground_withObject_',
]


def _get_className_methods(rubicon_object, is_revers: bool = True):
  objct_class = libobjc.object_getClass(rubicon_object)
  py_className_methods = {}

  while objct_class is not None:
    py_methods = []
    num_methods = ctypes.c_uint(0)
    method_list_ptr = libobjc.class_copyMethodList(objct_class,
                                                   ctypes.byref(num_methods))
    for i in range(num_methods.value):
      selector = libobjc.method_getName(method_list_ptr[i])
      sel_name = libobjc.sel_getName(selector).decode('ascii')
      py_method_name = sel_name.replace(':', '_')

      if '.' not in py_method_name:
        py_methods.append(py_method_name)
    libobjc.free(method_list_ptr)

    py_className_methods[str(ObjCInstance(objct_class.value))] = sorted(
      set(py_methods))

    objct_class = libobjc.class_getSuperclass(objct_class)

    if objct_class.value == NSObject.ptr.value:
      py_className_methods[str(NSObject)] = NSObject_instance_methods
      break

  _items = py_className_methods.items()
  _list_items = list(reversed(_items) if is_revers else _items)
  return dict(_list_items)


def state(rubicon_obj, indent: int = 2, is_reverse: bool = True):
  _dic = _get_className_methods(rubicon_obj, is_reverse)
  data = json.dumps(_dic, indent=indent)
  print(data)
  pprint(rubicon_obj)

```

### ã–ã£ãã‚Šè§£èª¬ã¨ã€ä½¿ã„æ–¹ã®å¤‰æ›´ç‚¹

[PythonistaAppTemplate/PythonistaAppTemplate/PythonistaKit.framework/pylib/site-packages/objc_util.py at f560f93f8876d82a21d108977f90583df08d55af Â· omz/PythonistaAppTemplate](https://github.com/omz/PythonistaAppTemplate/blob/f560f93f8876d82a21d108977f90583df08d55af/PythonistaAppTemplate/PythonistaKit.framework/pylib/site-packages/objc_util.py#L538)
@[card](https://github.com/omz/PythonistaAppTemplate/blob/f560f93f8876d82a21d108977f90583df08d55af/PythonistaAppTemplate/PythonistaKit.framework/pylib/site-packages/objc_util.py#L538)

`ObjCInstance` class ã®`__dir__` ã‚’å†™çµŒã€‚
æœ¬å®¶ï¼ˆobjc_utilï¼‰ ã ã¨ã€super class ã®method ã‚‚ã€`list` ã§ä¸€æ‹¬ã«ã¾ã¨ã‚ã‚‰ã‚Œã¦ã„ãŸãŒã€ä»Šå›ã¯class ã”ã¨ã«å–å¾—ã‚’ã—ã¦ã€`dict` å½¢å¼ã¨ã—ã¦key value ã§æŒãŸã›ã¦ã„ã‚‹ã€‚

`dict` ã‚’json ã¨ã—ã¦ã€æ•´å½¢ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã€class ã”ã¨ã®method ã®æ•´ç†ã‚‚ã§ããŸã®ã§ã€é–¢æ•°ã®å¼•æ•°ã¨ã—ã¦ã€`indent` ã¨`is_reverse` ã‚’ç”Ÿã‚„ã—ã¦ã„ã‚‹ã€‚

- `indent`: `int`
  - ã©ã®class ã®method ãªã®ã‹ãŒåˆ†ã‘ã‚‰ã‚Œã¦ã„ã‚‹
  - æ¨ªå¹…ãŒç‹­ã„iPhone ã ã¨æ©æµã‚’å—ã‘è¾›ã„ã‹ã‚‚ã—ã‚Œãªã„
- `is_reverse`: `bool`
  - å…ˆé ­ã‚’sub class ã‹`NSObject` ã‚’æ±ºã‚ã‚‰ã‚Œã‚‹
  - iPhone ã ã¨ã¨ã‚Šã‚ãˆãšã€å‡ºåŠ›æœ€çµ‚è¡Œã‹ã‚‰ãŒç¢ºèªã—ã‚„ã™ã„ã®ã§ã€`True`
